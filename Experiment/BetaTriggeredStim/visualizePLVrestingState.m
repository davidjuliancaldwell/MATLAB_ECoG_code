%% DJC 2-11-2016 - script to visualize PLVs within resting state and between resting state
% For use with data generated by PLVBetaRestingStateDJCbatchProcess
%%
cd c:\users\david\desktop\Research\RaoLab\MATLAB\Code\Experiment\BetaTriggeredStim
close all;clear all;clc
Z_ConstantsRest
%there appears to be no montage for this subject currently - assume all are
%64 channel grids right now which is fine because it's from TDT recording
% not looking at subject 1 right now

%%
for z = 2:length(SIDS)
    sid = SIDS{z};
    switch(sid)
        case 'd5cd55'
            subjid = sid;
            
            % post load
            
            suffixPost = 'postSegmentedShuffled';
            load(strcat(subjid, '_', suffixPost))
            postPLVs = signif_beta_plvs;
            
            
            % pre load
            suffixPre = 'preSegmentedShuffled';
            load(strcat(subjid,'_',suffixPre))
            prePLVs = signif_beta_plvs;
            
            
            % difference load
            suffixPre = 'PreVsPost';
            load(strcat(subjid,'_',suffixPre))
            diffsPLV = masked_beta_plvdiff2;
            stims = [54 62];
            betaChan = 53;
            
            
        case 'c91479'
            subjid = sid;
            
            % post load
            
            suffixPost = 'postSegmentedShuffled';
            load(strcat(subjid, '_', suffixPost))
            postPLVs = signif_beta_plvs;
            
            
            % pre load
            suffixPre = 'preSegmentedShuffled';
            load(strcat(subjid,'_',suffixPre))
            prePLVs = signif_beta_plvs;
            
            
            % difference load
            suffixPre = 'PreVsPost';
            load(strcat(subjid,'_',suffixPre))
            diffsPLV = masked_beta_plvdiff2;
            stims = [55 56];
            betaChan = 64;
            
            
        case '7dbdec'
            subjid = sid;
            
            % post load
            
            suffixPost = 'postSegmentedShuffled';
            load(strcat(subjid, '_', suffixPost))
            postPLVs = signif_beta_plvs;
            
            
            % pre load
            suffixPre = 'preSegmentedShuffled';
            load(strcat(subjid,'_',suffixPre))
            prePLVs = signif_beta_plvs;
            
            
            % difference load
            suffixPre = 'PreVsPost';
            load(strcat(subjid,'_',suffixPre))
            diffsPLV = masked_beta_plvdiff2;
            stims = [11 12];
            betaChan = 4;
            
        case '9ab7ab'
            subjid = sid;
            
            % post load
            
            suffixPost = 'postSegmentedShuffled';
            load(strcat(subjid, '_', suffixPost))
            postPLVs = signif_beta_plvs;
            
            
            % pre load
            suffixPre = 'preSegmentedShuffled';
            load(strcat(subjid,'_',suffixPre))
            prePLVs = signif_beta_plvs;
            
            
            % difference load
            suffixPre = 'PreVsPost';
            load(strcat(subjid,'_',suffixPre))
            diffsPLV = masked_beta_plvdiff2;
            stims = [59 60];
            betaChan = 51;
            
            
        case '702d24'
            subjid = sid;
            
            % post load
            
            suffixPost = 'postSegmentedShuffled';
            load(strcat(subjid, '_', suffixPost))
            postPLVs = signif_beta_plvs;
            
            
            % pre load
            suffixPre = 'preSegmentedShuffled';
            load(strcat(subjid,'_',suffixPre))
            prePLVs = signif_beta_plvs;
            
            
            % difference load
            suffixPre = 'PreVsPost';
            load(strcat(subjid,'_',suffixPre))
            diffsPLV = masked_beta_plvdiff2;
            stims = [13 14];
            betaChan = 5;
            
            
        case 'ecb43e'
            subjid = sid;
            
            % post load
            
            suffixPost = 'postSegmentedShuffled';
            load(strcat(subjid, '_', suffixPost))
            postPLVs = signif_beta_plvs;
            
            
            % pre load
            suffixPre = 'preSegmentedShuffled';
            load(strcat(subjid,'_',suffixPre))
            prePLVs = signif_beta_plvs;
            
            
            % difference load
            suffixPre = 'PreVsPost';
            load(strcat(subjid,'_',suffixPre))
            diffsPLV = masked_beta_plvdiff2;
            Montage.BadChannels = [54];
            stims = [56 64];
            betaChan = 55;
            
            
        case '0b5a2e'
            
            subjid = sid;
            
            % post load
            
            suffixPost = 'postSegmentedShuffled';
            load(strcat(subjid, '_', suffixPost))
            postPLVs = signif_beta_plvs;
            
            
            % pre load
            suffixPre = 'preSegmentedShuffled';
            load(strcat(subjid,'_',suffixPre))
            prePLVs = signif_beta_plvs;
            
            
            % difference load
            suffixPre = 'PreVsPost';
            load(strcat(subjid,'_',suffixPre))
            diffsPLV = masked_beta_plvdiff2;
            stims = [22 30];
            betaChan = 31;
            
            Montage.BadChannels = [25 29];
            
    end
    
    % Pre
    figure
    climsSingle = [0 1];
    imagesc(prePLVs,climsSingle)
    colormap('parula')
    colorbar
    title([sid ' Significant Pre Stim Beta PLV '])
    xlabel('Channel')
    ylabel('Channel')
    
    %     highlight(gca,[betaChan-0.5 length(postPLVs)+1],[betaChan-0.5 betaChan+0.5],[0.8 0.8 0.8])
    %     highlight(gca,[betaChan-0.5 betaChan+0.5],[0 betaChan-0.5],[0.8 0.8 0.8])
    %
    highlight(gca,[0 betaChan+0.5],[betaChan-0.5 betaChan+0.5],[0.9 0.9 0.9])
    highlight(gca,[betaChan-0.5 betaChan+0.5],[betaChan-0.5 length(postPLVs)+1],[0.9 0.9 0.9])
    
    gcf;
    SaveFig(OUTPUT_DIR, sprintf('prePLV-%s', sid), 'eps', '-r600');
    SaveFig(OUTPUT_DIR, sprintf('prePLV-%s', sid), 'png', '-r600');
    
    
    
    % Post
    figure
    climsSingle = [0 1];
    imagesc(postPLVs,climsSingle)
    colormap('parula')
    
    colorbar
    title([sid ' Significant Post Stimulation Beta PLV '])
    xlabel('Channel')
    ylabel('Channel')
    
    %     highlight(gca,[betaChan-0.5 length(postPLVs)+1],[betaChan-0.5 betaChan+0.5],[0.8 0.8 0.8])
    %     highlight(gca,[betaChan-0.5 betaChan+0.5],[0 betaChan-0.5],[0.8 0.8 0.8])
    
    highlight(gca,[0 betaChan+0.5],[betaChan-0.5 betaChan+0.5],[0.9 0.9 0.9])
    highlight(gca,[betaChan-0.5 betaChan+0.5],[betaChan-0.5 length(postPLVs)+1],[0.9 0.9 0.9])
    
    gcf;
    SaveFig(OUTPUT_DIR, sprintf('postPLV-%s', sid), 'eps', '-r600');
    SaveFig(OUTPUT_DIR, sprintf('postPLV-%s', sid), 'png', '-r600');
    
    % Diffs
    figure
    climsDiff = [-1 1];
    imagesc(diffsPLV,climsDiff)
    colormap('parula')
    
    colorbar
    title([sid ' Significant differences in Pre-Post Beta PLV'])
    xlabel('Channel')
    ylabel('Channel')
    
    %     highlight(gca,[betaChan-0.5 length(postPLVs)+1],[betaChan-0.5 betaChan+0.5],[0.8 0.8 0.8])
    %     highlight(gca,[betaChan-0.5 betaChan+0.5],[0 betaChan-0.5],[0.8 0.8 0.8])
    
    highlight(gca,[0 betaChan+0.5],[betaChan-0.5 betaChan+0.5],[0.9 0.9 0.9])
    highlight(gca,[betaChan-0.5 betaChan+0.5],[betaChan-0.5 length(postPLVs)+1],[0.9 0.9 0.9])
    
    gcf;
    SaveFig(OUTPUT_DIR, sprintf('diffsPLV-%s', sid), 'eps', '-r600');
    SaveFig(OUTPUT_DIR, sprintf('diffsPLV-%s', sid), 'png', '-r600');
    
end